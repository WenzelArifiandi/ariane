---
import Base from '../../layouts/Base.astro'
import { client } from '../../lib/sanity'
import { allProjects } from '../../lib/queries'
import { urlFor } from '../../lib/sanity'

type Project = {
  slug: string
  title: string
  year?: number
  hero?: any
}

const projects = await client.fetch<Project[]>(allProjects)
---
<Base title="Work â€” Ariane" description="Selected projects and case studies.">
  <h1 class="text-4xl font-semibold">Work</h1>
  <ul class="mt-8 grid gap-8 sm:grid-cols-2 lg:grid-cols-3">
    {projects.map((p: Project) => (
      <li class="group">
        <a href={`/work/${p.slug}`} class="block">
          {p.hero && <img
            src={urlFor(p.hero).width(800).height(600).fit('crop').auto('format').url()}
            alt={p.hero.alt} loading="lazy" class="aspect-[4/3] w-full object-cover rounded-lg" />}
          <div class="mt-3">
            <h2 class="text-xl font-medium group-hover:underline">{p.title}</h2>
            {p.year && <p class="text-sm text-neutral-500">{p.year}</p>}
          </div>
        </a>
      </li>
    ))}
  </ul>
</Base>