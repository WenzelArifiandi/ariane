---
import Base from '../layouts/Base.astro'
import Nav from '../components/Nav.astro'
import Hero from '../components/Hero.astro'
import Footer from '../components/Footer.astro'
import { client } from '../lib/sanity'
import { allProjects } from '../lib/queries'
import { urlFor } from '../lib/sanity'
import '../styles/global.css' // adjust the relative path if needed

const page = {
  title: 'Wenzel Arifiandi',
  description: 'Hi there!',
  url: 'https://wenzelarifiandi.com/',
  image: '/og.jpg',
}
const email = 'hello@wenzelarifiandi.com'
let projects: any[] = []
try { projects = await client.fetch(allProjects) } catch { projects = [] }
---

<Base title={page.title} description={page.description} ogImage={page.image} pathname="/">
  <Nav />
  <Hero />

  {/* Work anchor */}
  <section id="work" class="container align-hero">
    <div class="section__inner">
      <h2>Work</h2>
      {projects?.length ? (
        <ul class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3 mt-4">
          {projects.slice(0, 3).map((p) => (
            <li class="rounded-xl border overflow-hidden hover:shadow-sm transition-shadow">
              <a href={`/work/${p.slug}`} class="block">
                {p.hero && (
                  <img
                    src={urlFor(p.hero).width(800).height(500).fit('crop').auto('format').url()}
                    alt={p.hero.alt}
                    class="aspect-[16/10] w-full object-cover"
                    loading="lazy"
                  />
                )}
                <div class="p-4">
                  <h3 class="font-semibold">{p.title}</h3>
                  {p.year && <p class="text-sm text-neutral-500 mt-1">{p.year}</p>}
                </div>
              </a>
            </li>
          ))}
        </ul>
      ) : (
        <p class="muted">Publish some <code>Project</code> docs in Studio to see them here.</p>
      )}
      <p class="mt-4"><a class="accent" href="/work">View all work â†’</a></p>
    </div>
  </section>

  {/* About anchor */}
  <section id="about" class="container align-hero">
    <div class="section__inner">
      <h2>About</h2>
      <p class="muted">More details coming shortly.</p>
    </div>
  </section>

  {/* Contact anchor */}
  <section id="contact" class="container align-hero">
    <div class="section__inner">
      <h2>Contact</h2>
      <p class="muted">Email me at <a href={`mailto:${email}`} class="accent">{email}</a>.</p>
    </div>
  </section>
  <Footer />
</Base>

<style>
  .wrap { max-width: 1100px; margin: 3rem auto; padding: 0 var(--pad-x); }
  h2 { font-size: var(--h2); letter-spacing: -0.01em; margin-bottom: .5rem; }
  .muted { color: color-mix(in oklab, var(--ink), black 25%); }
  .section__inner { padding-left: var(--pad-x); }
  #work, #about, #contact { padding-block: 28px; }
  /* Add space before footer */
  #contact { padding-bottom: clamp(64px, 10vw, 120px); }
</style>
